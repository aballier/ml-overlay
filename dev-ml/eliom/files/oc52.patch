From 583668015c347927675fcf32e3861797894f784c Mon Sep 17 00:00:00 2001
From: Vincent Balat <vincent.balat@vblt.org>
Date: Fri, 8 Mar 2024 16:15:09 +0100
Subject: [PATCH] Update to OCaml 5.2

---
 CHANGES                    | 2 ++
 src/ppx/ppx_eliom_utils.ml | 4 +++-
 2 files changed, 5 insertions(+), 1 deletion(-)

diff --git a/src/ppx/ppx_eliom_utils.ml b/src/ppx/ppx_eliom_utils.ml
index 2978abe2e..f165c443e 100644
--- a/src/ppx/ppx_eliom_utils.ml
+++ b/src/ppx/ppx_eliom_utils.ml
@@ -351,7 +351,9 @@ module Cmo = struct
     let rec type_of_out_type ty =
       match ty with
       | Otyp_var (_, s) -> Typ.var (var s)
-      | Otyp_arrow (lab, ty1, ty2) ->
+      | ((Otyp_arrow (lab, ty1, ty2)) [@if ocaml_version >= (5, 2, 0)]) ->
+          Typ.arrow lab (type_of_out_type ty1) (type_of_out_type ty2)
+      | ((Otyp_arrow (lab, ty1, ty2)) [@if ocaml_version < (5, 2, 0)]) ->
           Typ.arrow (label_of_string lab) (type_of_out_type ty1)
             (type_of_out_type ty2)
       | Otyp_tuple tyl -> Typ.tuple (List.map type_of_out_type tyl)
